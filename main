from flask import Flask, request, jsonify
import requests
from flask_cors import CORS

app = Flask(__name__)
CORS(app)

RAPIDAPI_KEY = "46403d3367msh1ab84eeeaf59525p10144ejsn69c6b110d730"
RAPIDAPI_HOST = "spoonacular-recipe-food-nutrition-v1.p.rapidapi.com"

@app.route('/wine-pairing', methods=['GET'])
def wine_pairing():
    food = request.args.get('food')
    if not food:
        return jsonify({"error": "Missing 'food' parameter"}), 400

    url = f"https://{RAPIDAPI_HOST}/food/wine/pairing"
    querystring = {"food": food}

    headers = {
        "X-RapidAPI-Key": RAPIDAPI_KEY,
        "X-RapidAPI-Host": RAPIDAPI_HOST
    }

    response = requests.get(url, headers=headers, params=querystring)

    return jsonify(response.json()), response.status_code

if __name__ == '__main__':
    import os
    port = int(os.environ.get('PORT', 5000))
    app.run(host='0.0.0.0', port=port)
